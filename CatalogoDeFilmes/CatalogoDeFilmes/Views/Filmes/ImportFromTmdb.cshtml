@model CatalogoDeFilmes.Models.Filme

@{
    ViewData["Title"] = "Importar Filme do TMDb";
}

<div class="row">
    <div class="col-md-8 offset-md-2">
        <h1><i class="bi bi-download"></i> Importar Filme do TMDb</h1>
        <p class="text-muted">Complete os dados de localização e salve o filme no seu catálogo.</p>
        <hr />

        <div class="card mb-4 bg-light">
            <div class="card-body">
                <h5 class="card-title">@Model.Titulo</h5>
                @if (!string.IsNullOrEmpty(Model.TituloOriginal))
                {
                    <h6 class="card-subtitle mb-2 text-muted">@Model.TituloOriginal</h6>
                }
                
                @if (Model.DataLancamento.HasValue)
                {
                    <p class="mb-1"><strong>Lançamento:</strong> @Model.DataLancamento.Value.ToString("dd/MM/yyyy")</p>
                }
                
                @if (!string.IsNullOrEmpty(Model.Genero))
                {
                    <p class="mb-1"><strong>Gênero:</strong> @Model.Genero</p>
                }
                
                @if (Model.NotaMedia.HasValue)
                {
                    <p class="mb-1">
                        <strong>Nota:</strong> 
                        <span class="badge bg-warning text-dark"><i class="bi bi-star-fill"></i> @Model.NotaMedia.Value.ToString("F1")/10</span>
                    </p>
                }
                
                @if (!string.IsNullOrEmpty(Model.Sinopse))
                {
                    <p class="mb-0 mt-2"><strong>Sinopse:</strong><br />@Model.Sinopse</p>
                }
            </div>
        </div>

        <form asp-action="ImportFromTmdbConfirmed" method="post">
            @Html.AntiForgeryToken()

            @Html.HiddenFor(m => m.TmdbId)
            @Html.HiddenFor(m => m.PosterPath)
            @Html.HiddenFor(m => m.TituloOriginal)
            @Html.HiddenFor(m => m.Sinopse)
            @Html.HiddenFor(m => m.DataLancamento)
            @Html.HiddenFor(m => m.Genero)
            @Html.HiddenFor(m => m.Lingua)
            @Html.HiddenFor(m => m.Duracao)
            @Html.HiddenFor(m => m.NotaMedia)
            @Html.HiddenFor(m => m.ElencoPrincipal)

            <div class="mb-3">
                <label asp-for="Titulo" class="form-label"></label>
                <input asp-for="Titulo" class="form-control" required />
                <span asp-validation-for="Titulo" class="text-danger"></span>
                <small class="form-text text-muted">Você pode editar o título se preferir uma versão diferente</small>
            </div>

            <hr />
            <h5><i class="bi bi-geo-alt"></i> Localização (para previsão do tempo)</h5>
            <p class="text-muted">Informe a cidade e coordenadas para exibir a previsão do tempo nas informações do filme. Esta informação é opcional mas recomendada.</p>

            <div class="mb-3">
                <label asp-for="CidadeReferencia" class="form-label"></label>
                <input asp-for="CidadeReferencia" class="form-control" placeholder="Ex: São Paulo, Rio de Janeiro, Nova York" />
            </div>

            <div class="row">
                <div class="col-md-6 mb-3">
                    <label asp-for="Latitude" class="form-label"></label>
                    <input asp-for="Latitude" type="number" step="0.000001" class="form-control" placeholder="-23.550520" />
                    <small class="form-text text-muted">Valor entre -90 e 90</small>
                </div>
                <div class="col-md-6 mb-3">
                    <label asp-for="Longitude" class="form-label"></label>
                    <input asp-for="Longitude" type="number" step="0.000001" class="form-control" placeholder="-46.633308" />
                    <small class="form-text text-muted">Valor entre -180 e 180</small>
                </div>
            </div>

            <div class="alert alert-info">
                <i class="bi bi-lightbulb"></i>
                <strong>Dica:</strong> Use o 
                <a href="https://www.google.com/maps" target="_blank" rel="noopener">Google Maps</a> 
                para encontrar as coordenadas de uma cidade. Clique com o botão direito no mapa e copie as coordenadas.
            </div>

            <div class="d-flex gap-2 mt-4">
                <button type="submit" class="btn btn-success btn-lg"><i class="bi bi-save"></i> Salvar no Catálogo</button>
                <a asp-action="SearchTmdb" class="btn btn-secondary btn-lg"><i class="bi bi-x-circle"></i> Cancelar</a>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    @await Html.PartialAsync("_ValidationScriptsPartial")
}
